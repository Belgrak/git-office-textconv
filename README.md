# Git Office Textconv

–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π Git-—Ñ–∏–ª—å—Ç—Ä, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å **—Ç–µ–∫—Å—Ç–æ–≤—ã–π diff** –¥–ª—è –±–∏–Ω–∞—Ä–Ω—ã—Ö –æ—Ñ–∏—Å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ (PDF, Docx, Xlsx, PPTx –∏ –¥—Ä.).

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞ –∏ –≤—ã–∑—ã–≤–∞–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é —É—Ç–∏–ª–∏—Ç—É (`pandoc`, `pdftotext`, `ssconvert` –∏ –¥—Ä.) –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞, —á—Ç–æ–±—ã –∫–æ–º–∞–Ω–¥–∞ `git diff` –ø–æ–∫–∞–∑—ã–≤–∞–ª–∞ –ø–æ–ª–µ–∑–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤–º–µ—Å—Ç–æ `Binary files differ`.

## ‚ú® –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã

| –¢–∏–ø | –§–æ—Ä–º–∞—Ç—ã | –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã (–ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É) |
|---|---|---|
| **–î–æ–∫—É–º–µ–Ω—Ç—ã** | `.pdf` | `pdftotext` (poppler), `tesseract` (OCR) |
| **Word** | `.docx`, `.odt`, `.epub` | `pandoc`, `docx2txt`, `odt2txt` |
| **Legacy Word** | `.doc` | `antiword`, `catdoc` |
| **–¢–∞–±–ª–∏—Ü—ã** | `.xlsx`, `.xls`, `.ods` | `ssconvert` (gnumeric), `xlsx2csv` |
| **–ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–∏** | `.pptx`, `.ppt`, `.odp` | `pptx2md`, `catppt`, `soffice` (LibreOffice) |

## üì¶ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

–î–ª—è —Ä–∞–±–æ—Ç—ã —Å–∫—Ä–∏–ø—Ç–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤–Ω–µ—à–Ω–∏–µ —É—Ç–∏–ª–∏—Ç—ã.

**Ubuntu / Debian:**
```bash
sudo apt update
sudo apt install poppler-utils pandoc antiword catdoc gnumeric libreoffice-common
# –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –¥–ª—è PPTX –∏ OCR:
sudo apt install python3-pip tesseract-ocr
pip3 install pptx2md
```

**macOS (Homebrew):**
```bash
brew install poppler pandoc antiword catdoc gnumeric
```

## üõ† –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∫—Ä–∏–ø—Ç–∞
–°–∫–∞—á–∞–π—Ç–µ —Å–∫—Ä–∏–ø—Ç, –ø–æ–º–µ—Å—Ç–∏—Ç–µ –µ–≥–æ –≤ —É–¥–æ–±–Ω–æ–µ –º–µ—Å—Ç–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `~/bin`) –∏ –¥–∞–π—Ç–µ –ø—Ä–∞–≤–∞ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ:

```bash
chmod +x git-office-textconv
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Git (–ì–ª–æ–±–∞–ª—å–Ω–æ)
–°–æ–æ–±—â–∏—Ç–µ Git, –≥–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä:

```bash
# –ó–∞–º–µ–Ω–∏—Ç–µ /path/to/ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π –ø—É—Ç—å –∫ —Å–∫—Ä–∏–ø—Ç—É
git config --global diff.office.textconv "/path/to/git-office-textconv"

# –í–∫–ª—é—á–µ–Ω–∏–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è (–∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏!)
git config --global diff.office.cachetextconv true
```

### 3. –ü—Ä–∏–≤—è–∑–∫–∞ –∞—Ç—Ä–∏–±—É—Ç–æ–≤
–î–æ–±–∞–≤—å—Ç–µ –≤ —Ñ–∞–π–ª `.gitattributes` (–≤ –∫–æ—Ä–Ω–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –∏–ª–∏ –≥–ª–æ–±–∞–ª—å–Ω–æ) —Å–ª–µ–¥—É—é—â–∏–µ —Å—Ç—Ä–æ–∫–∏, —á—Ç–æ–±—ã —Å–≤—è–∑–∞—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è —Å —Ñ–∏–ª—å—Ç—Ä–æ–º `office`:

```ini
*.pdf diff=office
*.doc diff=office
*.docx diff=office
*.odt diff=office
*.xls diff=office
*.xlsx diff=office
*.ppt diff=office
*.pptx diff=office
```

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

–ü—Ä–æ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Git –∫–∞–∫ –æ–±—ã—á–Ω–æ. –¢–µ–ø–µ—Ä—å –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –±–∏–Ω–∞—Ä–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –≤—ã —É–≤–∏–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç:

```bash
git diff my_document.docx
git show HEAD:budget.xlsx
```

## ü§ù CI

–í –ø—Ä–æ–µ–∫—Ç–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω **GitHub Actions**.
–ü—Ä–∏ –∫–∞–∂–¥–æ–º Push –∏ Pull Request –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è:
*   **ShellCheck**;
*   –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ —Å–∫—Ä–∏–ø—Ç–∞;

–ü–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π PR —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∫—Ä–∏–ø—Ç –ª–æ–∫–∞–ª—å–Ω–æ:
```bash
shellcheck git-office-textconv
```
